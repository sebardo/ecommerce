{% extends "AdminBundle:Base:layout.html.twig" %}

{% block section %}dashboard-product{% endblock %}

{% block content %}
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        Dashboard
        <small>Control panel</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Dashboard</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content">
      <!-- Small boxes (Stat box) -->
      <div class="row">
          
        <div class="col-lg-3 col-xs-6">
          <!-- small box -->
          <div class="small-box bg-red">
            <div class="inner">
              <h3>{{totalVisits}}</h3>
              <p>Visitantes unicos</p>
            </div>
            <div class="icon">
              <i class="ion ion-pie-graph"></i>
            </div>
            <a href="#" class="small-box-footer"> <i class="fa fa-arrow-circle-right"></i></a>
          </div>
        </div><!-- ./col -->
        
        <div class="col-lg-3 col-xs-6">
          <!-- small box -->
          <div class="small-box bg-aqua">
            <div class="inner">
              <h3>{{totalProductVisited}}</h3>
              <p>Productos visitadas</p>
            </div>
            <div class="icon">
              <i class="ion ion-eye"></i>
            </div>
            <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
          </div>
        </div><!-- ./col -->
        <div class="col-lg-3 col-xs-6">
          <!-- small box -->
          <div class="small-box bg-green">
            <div class="inner">
              <h3>{{bounceRate}}<sup style="font-size: 20px">%</sup></h3>
              <p>Porcentaje Rebote</p>
            </div>
            <div class="icon">
              <i class="ion ion-stats-bars"></i>
            </div>
            <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
          </div>
        </div><!-- ./col -->
        <div class="col-lg-3 col-xs-6">
          <!-- small box -->
          <div class="small-box bg-yellow">
            <div class="inner">
              <h3>{{totalProducts}}</h3>
              <p>Productos Registradas</p>
            </div>
            <div class="icon">
              <i class="ion ion-android-playstore"></i>
            </div>
            <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
          </div>
        </div><!-- ./col -->
        
      </div><!-- /.row -->
      
      <div class="row">
          <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-teal-gradient">
              <div class="inner">
                <h3>{{cuponCount}}</h3>
                <p>Cupón/es adquiridos</p>
              </div>
              <div class="icon">
                <i class="ion ion-scissors"></i>
              </div>
              <a href="#" class="small-box-footer"> <i class="fa fa-arrow-circle-right"></i></a>
            </div>
          </div><!-- ./col -->
          
          <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-info">
              <div class="inner"  style="min-height: 102px">
                <h3 style="line-height: 21px;font-size: 28px;white-space: normal;">{{bestSeller.name}}</h3>
                <p>Mas vendido</p>
              </div>
              <div class="icon">
                <i class="ion  ion-ios-star"></i>
              </div>
              <a href="#" class="small-box-footer"> <i class="fa fa-arrow-circle-right"></i></a>
            </div>
          </div><!-- ./col -->
          
          <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-black-gradient">
              <div class="inner">
                <h3>{{totalAmount}} €</h3>
                <p>Ingresos totales</p>
              </div>
              <div class="icon">
                  <i class="ion ion-social-euro white" style="color: #fff"></i>
              </div>
              <a href="#" class="small-box-footer"> <i class="fa fa-arrow-circle-right"></i></a>
            </div>
          </div><!-- ./col -->
          
          <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-purple-gradient">
                <div class="inner">
                <h3 >{{totalTransactions}}</h3>
                <p>Total de ventas</p>
              </div>
              <div class="icon">
                <i class="ion ion-android-checkbox-outline"></i>
              </div>
              <a href="#" class="small-box-footer"> <i class="fa fa-arrow-circle-right"></i></a>
            </div>
          </div><!-- ./col -->
      </div>
      <!-- Main row -->
      <div class="row">
          <section class="col-lg-12 connectedSortable">

         
          <!-- solid sales graph -->
          <div class="box box-solid bg-purple-gradient">
            <div class="box-header">
              <i class="fa fa-th"></i>
              <h3 class="box-title">Estadísticas de visitas de productos</h3>
              <div class="box-tools pull-right">
                <button class="btn bg-purple btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                <button class="btn bg-purple btn-sm" data-widget="remove"><i class="fa fa-times"></i></button>
              </div>
            </div>
            <div class="box-body border-radius-none">
              <div class="chart" id="line-chart" style="height: 250px;"></div>
            </div><!-- /.box-body -->
            
          </div><!-- /.box -->

        

        </section>
          
          
        
        <!-- Left col -->
        <section class="col-lg-12 connectedSortable">
            
            
          <div class="box box-solid bg-light-blue-gradient">
            <div class="box-header">
              <i class="fa fa-th"></i>
              <h3 class="box-title">Productos más visitadas</h3>
              <div class="box-tools pull-right">
                <button class="btn bg-light-blue btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                <button class="btn bg-light-blue btn-sm" data-widget="remove"><i class="fa fa-times"></i></button>
              </div>
            </div>
            <div class="box-body border-radius-none">
              <div class="table-responsive">
                    {% if report is not null%}
                        <table class="table">
                            <tr>
                                <th>Posición</th>
                                <th>ID</th>
                                <th>Producto</th>
                                <th>Visitas</th>
                            </tr>
                            <!-- .table - Uses sparkline charts-->
                            {% for line in report %}
                                <tr>
                                    <td>{{loop.index}}</td>
                                    <td>{{line.id}}</td>
                                    <td><a style="color: #fff;" href="{{ path('ecommerce_product_show', {id: line.id} ) }}">{{line.name}}</a></td>
                                    <td><b>{{line.visit}}</b></td>
                                </tr>
                            {% endfor %}
                        </table><!-- /.table -->
                    {% endif %}
                </div>
            </div><!-- /.box-body -->
            
          </div><!-- /.box -->


        </section><!-- /.Left col -->
 
      </div><!-- /.row (main row) -->

    </section><!-- /.content -->
     
{% endblock %}
 

{% block javascripts %}
    {{parent()}}
    
     
    <script>
        
       "use strict";

       $(function () {
         /* Morris.js Charts */
         // Sales chart
         
         var line = new Morris.Line({
           element: 'line-chart',
           resize: true,
           data: [
             {% for stat in stats%}
              {y: '{{stat.day}}', item1: {{stat.visit}} } {% if not loop.last%},{%endif%}
             {% endfor %}
           ],
           xkey: 'y',
           ykeys: ['item1'],
           labels: ['Visitas'],
           lineColors: ['#efefef'],
           lineWidth: 2,
           hideHover: 'auto',
           gridTextColor: "#fff",
           gridStrokeWidth: 0.4,
           pointSize: 4,
           pointStrokeColors: ["#efefef"],
           gridLineColor: "#efefef",
           gridTextFamily: "Open Sans",
           gridTextSize: 10
         });

      


         /* BOX REFRESH PLUGIN EXAMPLE (usage with morris charts) */
         $("#loading-example").boxRefresh({
           source: "ajax/dashboard-boxrefresh-demo.php",
           onLoadDone: function (box) {
             bar = new Morris.Bar({
               element: 'bar-chart',
               resize: true,
               data: [
                 {y: '2006', a: 100, b: 90},
                 {y: '2007', a: 75, b: 65},
                 {y: '2008', a: 50, b: 40},
                 {y: '2009', a: 75, b: 65},
                 {y: '2010', a: 50, b: 40},
                 {y: '2011', a: 75, b: 65},
                 {y: '2012', a: 100, b: 90}
               ],
               barColors: ['#00a65a', '#f56954'],
               xkey: 'y',
               ykeys: ['a', 'b'],
               labels: ['CPU', 'DISK'],
               hideHover: 'auto'
             });
           }
         });



       });

    </script>
{% endblock %}